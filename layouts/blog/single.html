{{ define "main" }}
<article>
  <!-- Hero Banner with Title Overlay -->
  <header class="blog-post__header"{{ if not .Params.image }}{{/* Get gradient colors based on category when no image */}}
    {{ $gradientColors := dict
      "Open Education" (dict "from" "#71B3B5" "to" "#2E6060")
      "Open Science" (dict "from" "#EDB88B" "to" "#D6A570")
      "Community" (dict "from" "#AC87A0" "to" "#8B6A8F")
      "Science Communication" (dict "from" "#71B3B5" "to" "#5A9A9C")
    }}
    {{ $postCategory := .Params.category }}
    {{ $colors := index $gradientColors $postCategory | default (dict "from" "#71B3B5" "to" "#2E6060") }}
    style="background: linear-gradient(135deg, {{ $colors.from }} 0%, {{ $colors.to }} 100%);"
  {{ end }}>
    {{ with .Params.image }}
    <img src="{{ . }}" alt="{{ $.Params.image_alt | default $.Title }}" />
    {{ end }}
    
    <!-- Dark gradient overlay -->
    <div></div>

    <!-- Title and metadata overlaid on image -->
    <div>
      <h1>{{ .Title }}</h1>
      <p>{{ .Date.Format "Jan 2, 2006" }}{{ with .Params.category }} • {{ . }}{{ end }}</p>
    </div>

    <!-- Photo credit in bottom right -->
    {{ if or .Params.photo_credit_author .Params.photo_credit_description }}
    <div>
      {{ with .Params.photo_credit_author }}{{ . }}{{ end }}
      {{ if and .Params.photo_credit_author .Params.photo_credit_description }} • {{ end }}
      {{ with .Params.photo_credit_description }}{{ . }}{{ end }}
    </div>
    {{ end }}
  </header>

  <!-- Excerpt below banner -->
  {{ with .Params.excerpt }}
  <div class="blog-post__excerpt">
    <p>{{ . | markdownify }}</p>
  </div>
  {{ end }}

  <!-- Main content -->
  <div class="blog-post__content">
    {{ .Content }}

    {{ partial "learn-more.html" . }}
  </div>

  <!-- Tags footer -->
  <footer class="blog-post__tags">
    {{ with .Params.tags }}Tags: {{ range $i, $t := . }}{{ if $i }}, {{ end }}<a href="{{ "/tags/" | relURL }}{{ urlize $t }}">{{ $t }}</a>{{ end }}{{ end }}
  </footer>
</article>
{{ end }}

